<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶Šå—èªå–®å­—å¡ (3000å–®æŒ‘æˆ°)</title>
    <style>
        body { font-family: 'Microsoft JhengHei', sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; }
        
        /* åˆ†é¡æŒ‰éˆ•å€ */
        .category-container {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 15px;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .cat-btn {
            padding: 8px 16px;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 20px;
            cursor: pointer;
            white-space: nowrap;
            transition: 0.2s;
        }
        .cat-btn.active, .cat-btn:hover {
            background: #d32f2f;
            color: white;
            border-color: #d32f2f;
        }

        /* å¡ç‰‡å€ */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); /* è‡ªå‹•æ’ç‰ˆ */
            gap: 15px;
        }
        .card {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
        }
        .card:active { transform: scale(0.95); }
        .card h3 { margin: 5px 0; color: #d32f2f; font-size: 1.2rem; }
        .card p { margin: 0; color: #666; font-size: 0.9rem; }
        .icon { font-size: 24px; margin-bottom: 5px; display: block; }
        
        /* æ’­æ”¾ä¸­çš„ç‰¹æ•ˆ */
        .playing { border: 2px solid #d32f2f; background-color: #fff5f5; }
    </style>
</head>
<body>
<div style="margin-bottom: 20px; text-align: center;">
    <input type="text" id="searchInput" placeholder="ğŸ” æœå°‹å–®å­—æˆ–ä¸­æ–‡..." 
           style="width: 100%; max-width: 400px; padding: 12px; border-radius: 25px; border: 1px solid #ccc; font-size: 16px; outline: none;">
</div>



    <div class="category-container" id="categoryList">
        <button class="cat-btn active" onclick="filterData('all')">å…¨éƒ¨</button>
    </div>

    <div class="grid" id="cardContainer"></div>

    <script src="data.js"></script>

    <script>
        // ç¢ºèªè³‡æ–™æ˜¯å¦æœ‰è®€é€²ä¾†
        if (typeof wordList === 'undefined') {
            alert("âš ï¸ éŒ¯èª¤ï¼šæ‰¾ä¸åˆ° data.jsï¼è«‹ç¢ºèªæ‚¨å·²ç¶“åŸ·è¡Œé Python ç¨‹å¼ã€‚");
        }

        const container = document.getElementById('cardContainer');
        const catContainer = document.getElementById('categoryList');
        let currentAudio = null;

        // 1. åˆå§‹åŒ–ï¼šç”¢ç”Ÿåˆ†é¡æŒ‰éˆ•
        function initCategories() {
            // æ‰¾å‡ºæ‰€æœ‰ä¸é‡è¤‡çš„åˆ†é¡
            const categories = [...new Set(wordList.map(item => item.category))];
            
            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.className = 'cat-btn';
                btn.innerText = cat;
                btn.onclick = () => filterData(cat, btn);
                catContainer.appendChild(btn);
            });
        }

        // 2. æ¸²æŸ“å¡ç‰‡ (æ ¸å¿ƒåŠŸèƒ½)
        function renderCards(data) {
            container.innerHTML = ''; // æ¸…ç©ºç•«é¢
            
            data.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <span class="icon">ğŸ”Š</span>
                    <h3>${item.vi}</h3>
                    <p>${item.zh}</p>
                `;
                
                // é»æ“Šæ’­æ”¾äº‹ä»¶
                card.onclick = () => playSound(item.file, card);
                
                container.appendChild(card);
            });
        }

        // 3. éæ¿¾åŠŸèƒ½
        function filterData(category, btnElement) {
            // æ›´æ–°æŒ‰éˆ•æ¨£å¼
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            if(btnElement) btnElement.classList.add('active');
            else document.querySelector('.cat-btn').classList.add('active'); // é è¨­å…¨éƒ¨

            // ç¯©é¸è³‡æ–™
            if (category === 'all') {
                renderCards(wordList);
            } else {
                const filtered = wordList.filter(item => item.category === category);
                renderCards(filtered);
            }
        }

        // 4. æ’­æ”¾è²éŸ³
        function playSound(filename, cardElement) {
            const path = `vietnam_audio/${filename}`;
            
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
            }

            // è¦–è¦ºå›é¥‹
            document.querySelectorAll('.card').forEach(c => c.classList.remove('playing'));
            cardElement.classList.add('playing');

            currentAudio = new Audio(path);
            currentAudio.play().catch(e => console.error("æ’­æ”¾å¤±æ•—:", e));
            
            // æ’­æ”¾çµæŸå¾Œç§»é™¤ç‰¹æ•ˆ
            currentAudio.onended = () => cardElement.classList.remove('playing');
        }

        // å•Ÿå‹•ï¼
        initCategories();
        renderCards(wordList);




// --- æ–°å¢ï¼šæœå°‹åŠŸèƒ½ ---
const searchInput = document.getElementById('searchInput');

searchInput.addEventListener('input', (e) => {
    const keyword = e.target.value.toLowerCase(); // è½‰å°å¯«ä»¥ä¸åˆ†å¤§å°å¯«æœå°‹
    
    // å¦‚æœæœå°‹æ¡†æ˜¯ç©ºçš„ï¼Œå°±æ¢å¾©é¡¯ç¤ºå…¨éƒ¨ (æˆ–ç›®å‰çš„åˆ†é¡)
    if(keyword === '') {
        const activeBtn = document.querySelector('.cat-btn.active');
        // å¦‚æœæœ‰é¸åˆ†é¡å°±ç”¨åˆ†é¡ç¯©ï¼Œæ²’é¸å°±é¡¯ç¤ºå…¨éƒ¨
        if(activeBtn && activeBtn.innerText !== 'å…¨éƒ¨') {
            filterData(activeBtn.innerText, activeBtn);
        } else {
            filterData('all');
        }
        return;
    }

    // é–‹å§‹éæ¿¾ (åŒæ™‚æ¯”å° è¶Šå—æ–‡ å’Œ ä¸­æ–‡)
    const filtered = wordList.filter(item => 
        item.vi.toLowerCase().includes(keyword) || 
        item.zh.toLowerCase().includes(keyword)
    );
    
    renderCards(filtered);
});








    </script>
</body>
</html>